<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Ingresso Confirmado</title>
  <style>
    body { font-family: Arial; background: #fff8e1; padding: 2rem; text-align: center; }
    h2 { color: green; }
    .ingresso {
      background: white; padding: 1.5rem; border-radius: 12px;
      margin: 1rem auto; max-width: 500px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
      text-align: left;
    }
    .qr { text-align: center; margin: 1rem 0; }
    .logo { width: 100px; float: right; margin-left: 1rem; }
    .sec { font-weight: bold; font-size: 1.1rem; text-align: center; }
  </style>
</head>
<body>
  <h2>✅ Ingressos Gerados</h2>
  <div id="listaIngressos"></div>

  <script>
    const ingresso = JSON.parse(localStorage.getItem("ingressoFinal")) || {};
    const lista = document.getElementById("listaIngressos");

    const nomes = ingresso.nomes || [ingresso.nome]; // caso seja 1 ingresso
    nomes.forEach((nome, index) => {
      const genero = ingresso.generos ? ingresso.generos[index] : ingresso.genero;
      const codigoSeguranca = Math.floor(100000 + Math.random() * 900000);
      const qrCode = encodeURIComponent(
        "Evento: " + ingresso.evento.nome +
        "\nNome: " + nome +
        "\nCPF: " + ingresso.cpf +
        "\nPedido: " + ingresso.pedido +
        "\nGênero: " + genero +
        "\nCódigo: " + codigoSeguranca
      );

      lista.innerHTML += `
        <div class="ingresso">
          <img src="\${ingresso.evento.logo}" class="logo" alt="Logo do evento">
          <strong>Evento:</strong> \${ingresso.evento.nome}<br>
          <strong>Data:</strong> \${ingresso.evento.data}<br>
          <strong>Local:</strong> \${ingresso.evento.local}<br><br>
          <strong>Nome:</strong> \${nome}<br>
          <strong>Gênero:</strong> \${genero}<br>
          <strong>CPF:</strong> \${ingresso.cpf}<br>
          <strong>Pedido:</strong> \${ingresso.pedido}<br>
          <div class="qr">
            <img src="https://chart.googleapis.com/chart?cht=qr&chs=180x180&chl=\${qrCode}">
          </div>
          
          <div style="text-align:center; font-size:1rem; margin-top: 0.5rem; color: red; font-weight: bold;">
            ⚠️ Ingresso PENDENTE de validação
          </div>
          <div style="text-align:center; font-size:0.85rem; color: #555;">
            Este ingresso só será considerado válido após a confirmação do organizador.
          </div>

          <div class="sec">Cód. Segurança: \${codigoSeguranca}</div>
          <div style="text-align:center; margin-top: 0.8rem;">
            <img src="https://arretados.vercel.app/logo-arretados.png" width="80"><br>
            <small>Realização: Arretados Produções</small>
          </div>
        </div>
      `;
    });
  </script>
</body>
</html>
